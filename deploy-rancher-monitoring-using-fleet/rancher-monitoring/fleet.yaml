defaultNamespace: cattle-monitoring-system
helm:
  releaseName: rancher-monitoring
  repo: https://charts.rancher.io
  chart: rancher-monitoring
  version: 104.1.0+up57.0.3
targetCustomizations:
- name: AKS
  helm:
    values: 
      storageSpec:
        volumeClaimTemplate:
          spec:
            storageClassName: managed-csi
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 2Gi
            selector: {}
      grafana:
        persistence: 
          enabled: true
          storageClassName: "managed-csi"
          accessModes:
            - ReadWriteOnce
          size: 1Gi
  clusterSelector:
    matchLabels:
      AKS: true
- name: EKS
  helm:
    values:
      storageSpec:
        volumeClaimTemplate:
          spec:
            storageClassName: "ebs-sc"
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 2Gi
            selector: {}
      grafana:
        persistence: 
          enabled: true
          storageClassName: "ebs-sc"
          accessModes:
            - ReadWriteOnce
          size: 1Gi
  clusterSelector:
    matchLabels:
      EKS: true
diff:
  comparePatches:
    - apiVersion: admissionregistration.k8s.io/v1
      kind: MutatingWebhookConfiguration
      name: rancher-monitoring-admission
      operations:
        - {"op":"remove", "path":"/webhooks/0/failurePolicy"}
    - apiVersion: admissionregistration.k8s.io/v1
      kind: ValidatingWebhookConfiguration
      name: rancher-monitoring-admission
      operations:
        - {"op":"remove", "path":"/webhooks/0/failurePolicy"}
